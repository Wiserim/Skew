/*!
* Skew v0.4
* Copyright 2018 Marcin Walczak
*This file is part of Skew which is released under MIT license.
*See LICENSE for full license details.
*/
function Skew(e,t){"string"==typeof e?this.targets=document.querySelectorAll(e):e.nodeType?this.targets=[e]:this.targets=e,this.defaults={x:0,y:0,breakpoints:[],debounce:!1,debounceTime:50},this.options=this.defaults,this.timeout,this.update(t),this.skew();var s=this;return this.resizeEvent=function(){if(s.debounce){clearTimeout(s.timeout),s.timeout=setTimeout(function(){s.timeout=null,s.skew()},50)}else s.skew()},window.addEventListener("resize",this.resizeEvent),this}window.jQuery&&($.fn.skew=function(e){$.makeArray(arguments);return this.each(function(){var t=$.data(this,"skewjs");if(t)if("string"==typeof e)t[e]?(t[e].apply(t,s),"destroy"==e&&$.removeData(this,"skewjs")):$.error("Method "+e+" does not exist on Skew");else{var s=$.extend({x:0,y:0,breakpoints:[]},e);t.update(s)}else if("string"!=typeof e){var i=new Skew(this,s=$.extend({x:0,y:0,breakpoints:[]},e));return $.data(this,"skewjs",i),i}})}),Skew.prototype={skew:function(){for(var e=this,t=0;t<e.targets.length;t++){var s=e.targets[t],i=s.offsetWidth,n=s.offsetHeight,r=e.options.x,o=e.options.y;if(void 0!==e.options.breakpoints){var a=window.innerWidth;e.options.breakpoints.forEach(function(e){e.break>=a&&(r=e.x,o=e.y)})}skewXAngle=Math.atan(r/n),skewYAngle=Math.atan(o/i);var u="skew("+skewXAngle+"rad, "+skewYAngle+"rad)",d=s.getAttribute("style");if(null!==d){var f=d.indexOf("transform:");if(f<0)d+="transform: "+u+";",s.setAttribute("style",d);else{var h=f+d.substring(f).indexOf(";");h<f&&(h=d.length,u+=";");var b=d.indexOf("skew"),k=d.substring(0,h),l=d.substring(h);b<0?(d=k+" "+u+l,s.setAttribute("style",d)):(h=(f=d.indexOf("skew"))+d.substring(f).indexOf(")")+1,d=(k=d.substring(0,f))+u+(l=d.substring(h)),s.setAttribute("style",d))}}else d="transform: "+u+";",s.setAttribute("style",d)}return this},update:function(e){return this.options=this.parseSettings(e,this.options),console.log(e),console.log(this.options),this.skew(),this},destroy:function(){window.removeEventListener("resize",this.resizeEvent);for(var e=0;e<this.targets.length;e++){var t=this.targets[e],s=t.getAttribute("style"),i=s.indexOf("skew"),n=i+s.substring(i).indexOf(")")+1;if(i>-1){var r=s.substring(0,i),o=s.substring(n);t.setAttribute("style",r+o)}}},parseSettings:function(e,t){var s=void 0!==t?t:this.defaults;return void 0!==e&&(void 0!==e.x&&(s.x=e.x),void 0!==e.y&&(s.y=e.y),Array.isArray(e.breakpoints)&&(s.breakpoints=[],e.breakpoints.forEach(function(e){s.breakpoints.push({break:void 0!==e.break?e.break:0,x:void 0!==e.x?e.x:0,y:void 0!==e.y?e.y:0})})),void 0!==e.debounce&&(s.debounce=e.debounce),void 0!==e.debounceTime&&(s.debounceTime=e.debounceTime)),s}};
